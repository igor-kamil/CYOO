<template>
    <div class="border-black border-t-2 flex items-center h-12 sticky top-0 w-full z-10 bg-white">
        <div @click="$router.push(back)" class="cursor-pointer px-3 h-full border-r-2 flex items-center bg-black">
            <svg class="h-[28px] w-[28px]" style="fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;" version="1.1" viewBox="0 0 26 26" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:vectornator="http://vectornator.io" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs/>
<g id="Layer-1" vectornator:layerName="Layer 1">
<path d="M2.02291 12.9029C1.22896 13.8478 0.83153 15.0137 0.83153 16.4006C0.83153 17.5365 1.09527 18.5996 1.62366 19.5891C2.15114 20.5795 2.87506 21.4162 3.79451 22.0992C4.71396 22.7831 5.68161 23.3033 6.69656 23.6598C7.7115 24.0163 9.03838 24.1946 10.6763 24.1946C12.6971 24.1946 14.4078 23.8935 15.8101 23.2906C17.2116 22.6876 18.4057 21.7627 19.3906 20.5168C20.3756 19.2699 20.8685 17.9785 20.8685 16.6416C20.8685 14.8627 20.0636 13.4058 18.4557 12.2699C20.1345 12.209 21.4387 12.0034 22.3682 11.6515C23.2976 11.2995 24.0661 10.6965 24.6745 9.84257C25.2829 8.9886 25.5867 8.04368 25.5867 7.00782C25.5867 5.91285 25.2329 4.97521 24.5244 4.19672C23.8151 3.41732 22.9284 3.02808 21.8625 3.02808C20.8275 3.02808 19.9763 3.2991 19.3079 3.84204C18.6394 4.38498 18.3047 4.99794 18.3047 5.68185C18.3047 6.11384 18.4357 6.49035 18.6967 6.81229C18.9586 7.13424 19.3406 7.2943 19.8426 7.2943C20.2646 7.2943 20.6193 7.15424 20.9058 6.87231C21.1922 6.5913 21.335 6.2648 21.335 5.89284C21.335 5.5809 21.2195 5.25895 20.9885 4.92792C20.8075 4.666 20.7175 4.46592 20.7175 4.32495C20.7175 4.10396 20.8103 3.94026 20.9958 3.83476C21.1822 3.72926 21.4614 3.67652 21.8325 3.67652C22.5864 3.67652 23.2094 3.9348 23.7023 4.45318C24.1943 4.97066 24.4408 5.63092 24.4408 6.43487C24.4408 7.79177 23.8878 8.80216 22.7829 9.46515C21.677 10.139 19.9035 10.4755 17.4608 10.4755C14.737 10.4755 12.8572 10.983 11.8222 11.998C10.7872 13.0138 10.2698 14.1388 10.2698 15.3756C10.2698 16.2196 10.5635 16.9308 11.1519 17.5083C11.7394 18.0867 12.4406 18.3759 13.2546 18.3759C13.9376 18.3759 14.4978 18.164 14.9352 17.742C15.3727 17.32 15.5909 16.7926 15.5909 16.1596C15.5909 15.7176 15.4609 15.3729 15.1999 15.1265C14.938 14.88 14.6315 14.7572 14.2795 14.7572C13.9076 14.7572 13.6011 14.9 13.3601 15.1865C13.1191 15.473 12.9981 15.8376 12.9981 16.2796C12.9981 16.3306 13.0036 16.4206 13.0136 16.5516L13.029 16.7325C13.029 17.1545 12.8326 17.3655 12.4406 17.3655C12.0987 17.3655 11.7667 17.1845 11.4457 16.8226C11.1237 16.4606 10.9628 15.9986 10.9628 15.4357C10.9628 14.5008 11.4075 13.7223 12.2969 13.0993C13.1864 12.4754 14.1995 12.1644 15.3345 12.1644C16.7423 12.1644 17.8573 12.5636 18.6822 13.363C19.5061 14.1615 19.9181 15.1037 19.9181 16.1896C19.9181 17.8175 19.0814 19.2172 17.408 20.3885C15.7346 21.559 13.722 22.1447 11.3702 22.1447C8.88741 22.1447 6.81206 21.398 5.14413 19.9056C3.47529 18.4132 2.64133 16.828 2.64133 15.1492C2.64133 14.2852 2.92508 13.5386 3.49257 12.9101C4.06098 12.2826 4.66121 11.9679 5.29419 11.9679C5.78711 11.9679 6.28912 12.1889 6.80205 12.6318C7.28497 13.0438 7.68149 13.2494 7.99343 13.2494C8.27445 13.2494 8.48817 13.1593 8.63368 12.9783C8.77919 12.7974 8.85285 12.6064 8.85285 12.4054C8.85285 11.6014 8.15895 11.1995 6.77204 11.1995C6.56105 11.1995 6.39735 11.144 6.28185 11.033C6.16635 10.923 6.03812 10.6847 5.89806 10.3173C5.75619 9.95079 5.68616 9.50062 5.68616 8.96768C5.68616 7.78267 6.1709 6.72953 7.14128 5.81008C8.11166 4.88972 9.15388 4.43045 10.2698 4.43045C10.9628 4.43045 11.5557 4.6187 12.0487 4.99522C12.5407 5.37264 12.7871 5.86192 12.7871 6.46579C12.7871 6.86777 12.7062 7.26429 12.5461 7.65626C12.4452 7.89726 12.3952 8.05369 12.3952 8.12371C12.3952 8.3147 12.4861 8.41019 12.6671 8.41019C13.0381 8.41019 13.3928 8.15373 13.7293 7.64171C14.0658 7.12878 14.2341 6.57129 14.2341 5.96832C14.2341 5.16437 13.8857 4.47319 13.1864 3.89478C12.4879 3.31728 11.6167 3.02808 10.5708 3.02808C9.63589 3.02808 8.73463 3.27909 7.8652 3.78201C6.99576 4.28494 6.27912 4.9452 5.71617 5.76461C5.15413 6.58402 4.8722 7.47073 4.8722 8.42565C4.8722 9.26962 5.09866 10.1791 5.55065 11.154C3.99277 11.375 2.81685 11.9579 2.02291 12.9029" fill="#ffffff" fill-rule="nonzero" opacity="1" stroke="none" vectornator:layerName="path"/>
</g>
</svg>

        </div>
        <h1 class="text-xl text-center grow">
            Objekt forscher
        </h1>
        <div class="flex-1 px-3 border-l-2 border-transparent text-right" v-if="$route.name === 'my_collection'">
            <button class="bg-green rounded-xl text-sm px-3 py-1 font-bold" @click="scroll('share')">
                {{ $t('Share') }}
            </button>
        </div>
        <FavouritesCount v-else class="border-l-2 border-l-transparent px-4 py-2" :show-tooltip="isActive" />
    </div>
</template>

<script setup>
import { computed, ref } from 'vue'
import { useItemsStore } from '../stores/ItemsStore'
import { useRoute } from 'vue-router'
import FavouritesCount from './FavouritesCount.vue';

const route = useRoute()
const itemsStore = useItemsStore()

const count = computed(() => itemsStore.count)
const isActive = ref(false)

const displayTooltip = () => {
    isActive.value = true
    setTimeout(() => {
        isActive.value = false
    }, 3000)
}

const scroll = (id) => {
    document.getElementById(id).scrollIntoView({
        behavior: 'smooth'
    })
}

itemsStore.$onAction(({ name: actionName }) => {
    if (actionName === 'add') {
        displayTooltip()
    }
})

const back = computed(() => route.meta.back?.(route) ?? { name: 'home' })
</script>
